{"version":3,"sources":["fund.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fund.js","sourcesContent":["$(function( ){\n\n\t//Declare Fund Object\n\tvar fundObj \t \t= {};\n\n\t/** Read all hidden fields that came from Controller and delete the fields after read **/\n\tvar userId \t\t\t= $(\"input[name=user_id]\").val( );\n\t$(\"input[name=user_id]\").remove( );\n\n\tvar paypal_username = $(\"input[name=paypal_un]\").val( );\n\t$(\"input[name=paypal_un]\").remove( );\n\n\tvar payment_gateway = $(\"input[name=payment_gateway]\").val( );\n\t$(\"input[name=payment_gateway]\").remove( );\n\n\tvar id \t\t\t\t= $(\"input[name=projectId]\").val( );\n\t$(\"input[name=projectId]\").remove( );\n\n\tvar $incentive \t\t= $(\".fund-incentives-list\").find(\".incentive\");\n\t\n\tvar project_title\t= $(\"input[name=title]\").val( );\n\t$(\"input[name=title]\").remove( );\n\n\t/** End Read hidden fields **/\n\n\tif( $(\"input[name=donationAmt]\").length > 0 && $(\"input[name=donationAmt]\").val( ) != \"\" ){\n\t\tfundObj.amount = parseFloat( $(\"input[name=donationAmt]\").val( ) ).formatMoney(2, ',', '.');\n\t}else{\n\t\tfundObj.amount = 0.00\n\t}\n\t\n\tif( $(\"input[name=incentiveId]\").length > 0 && $(\"input[name=incentiveId]\").val( ) != \"\" ){\n\t\tfundObj.incentive = $(\"input[name=incentiveId]\").val( );\n\t\tfundObj.type \t  = \"incentive\";\n\n\t\tvar $fundedItem = $(\"[data-incentive-id=\" + fundObj.incentive + \"]\");\n\n\t\tfundObj.incentiveName \t= $fundedItem.find(\".title\").text( );\n\n\t\tif( $fundedItem.find(\"input[name=shippingRequired]\").val( ) == \"Y\" ){\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\"input[name=showShipping]\").val(\"Y\");\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".shipping-info\").show( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".shippingHR\").show( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").show( );\n\t\t}else{\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").hide( );\n\t\t}\n\n\t}else{\n\n\t\tfundObj.incentive = \"\";\n\t\tfundObj.type \t  = \"fund\";\n\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").hide( );\n\t}\t\n\n\tif( $(\"select[name=userAddressesBilling]\").children(\"option\").length == 1 ){\n\t\t$(\"select[name=userAddressesBilling]\").parent( ).hide( );\n\t}\n\n\tif( $(\"select[name=userAddresses]\").children(\"option\").length == 1 ){\n\t\t$(\"select[name=userAddresses]\").parent( ).hide( );\n\t} \n\n\t//Select Incentive on first page of checkout\n     $incentive.on(\"click\", function( ){\n\n     \tfundObj.incentive \t\t= $(this).data('incentive-id');\n     \tfundObj.incentiveName \t= $(this).find(\".title\").text( );\n\t\tfundObj.type \t\t\t= 'incentive';\n\n     \tif( $(this).find(\"input[name=shippingRequired]\").val( ) == \"Y\" ){\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\"input[name=showShipping]\").val(\"Y\");\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".shipping-info\").slideDown( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").show( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\"input[name=sameAsShipping]\").prop('checked', false);\n\t\t}else{\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\"input[name=showShipping]\").val(\"N\");\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".shipping-info\").slideUp( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").hide( );\n\t\t\t$(\"form[name=fundCheckoutForm]\").find(\"input[name=sameAsShipping]\").prop('checked', false);\n\t\t}\n\n        if( ! $(this).hasClass('selected') ){\n            $(\".fund-incentives-list\").find(\".incentive\").each( function( ){\n\n                if( $(this).hasClass('selected') ){\n\n                \tvar p = $(this).find(\".info>.price\").html( );\n\n                \t$(this).find('.donation').find(\"input[name=donationAmt]\").val( p.replace(\"$\", \"\").trim( ) );\n\n                    $(this).find('.donation').slideUp( );\n                    $(this).removeClass('selected');\n                }\n            });\n\n            if( $(\".fund-options\").find(\".details-fund\").hasClass('selected') ){\n\n                $(\".details-fund\").find('.donation').slideUp( );\n                $(\".details-fund\").find('.donation').find('input[type=text]').val(\"\");\n                $(\".details-fund\").removeClass('selected');\n            }\n\n            $(this).addClass('selected');\n            $(this).find(\".donation\").slideDown( );    \n        }\n    });\n\n    //Select the contribute button on the Incentive Page\n    $(\".fund-options\").find(\".details-fund\").on(\"click\", function( ){\n\n    \tfundObj.incentive \t\t= \"\";\n    \tfundObj.type\t  \t\t= 'fund';\n    \tfundObj.incentiveName \t= \"\";\n\n    \t$(\"form[name=fundCheckoutForm]\").find(\"input[name=showShipping]\").val(\"N\");\n\t\t$(\"form[name=fundCheckoutForm]\").find(\".shipping-info\").slideUp( );\n\t\t$(\"form[name=fundCheckoutForm]\").find(\".sameAsShipping-wrapper\").hide( );\n\n        if( ! $(this).hasClass('selected') ){\n            $(\".fund-incentives-list\").find(\".incentive\").each( function( ){\n\n                if( $(this).hasClass('selected') ){\n\n                \tvar p = $(this).find(\".info>.price\").html( );\n\n                \t$(this).find('.donation').find(\"input[name=donationAmt]\").val( p.replace(\"$\", \"\").trim( ) );\n\n                    $(this).find('.donation').slideUp( );\n                    $(this).removeClass('selected');\n                }\n            });\n\n            $(this).addClass('selected');\n            $(this).find(\".donation\").slideDown( );\n        }\n    });\n\n    //Action for Shipping Address Selection\n    $(\"select[name=userAddresses]\").on(\"change\", function( ){\n        \n        var addressSelected = $(this).find(\":selected\").val( );\n        \n        if( addressSelected == 0 ){\n            $(\"input[name=shippingAddress1]\").val( \"\" );\n            $(\"input[name=shippingAddress2]\").val( \"\" );\n            $(\"input[name=shippingCity]\").val( \"\" );\n            $(\"select[name=shippingState] option\").each( function( i ){\n            \tif( i > 0 ){\n            \t\t$(this).remove( );\n            \t}\n            });\n            $(\"input[name=shippingZip]\").val( \"\" );\n            $(\"select[name=shippingCountry]>option:eq(0)\").prop(\"selected\", true);\n        }else{\n            \n            var addressData = addressSelected.split(\"|\");\n\n            \n        \t$(\"input[name=shippingAddress1]\").val( addressData[2] );\n         \t$(\"input[name=shippingAddress2]\").val( addressData[3] );\n            $(\"input[name=shippingCity]\").val( addressData[4] );\n            $(\"input[name=shippingZip]\").val( addressData[6] );\n\n            $(\"select[name=shippingState] option\").each( function( i ){\n            \tif( i > 0 ){\n            \t\t$(this).remove( );\n            \t}\n            });\n            \n\t\t\t$(\"select[name=shippingCountry]\").find(\"option[value=\" + addressData[7] + \"]\").prop(\"selected\", true);\n\n\t\t\t$(\"select[name=shippingCountry]\").trigger(\"change\");\n\n            setTimeout( function( ){\n            \t$(\"select[name=shippingState]\").find(\"option[value=\" + addressData[5] + \"]\").prop(\"selected\", true);\n\t\t\t}, 1000);\n        }\n    });\n    \n      //Action for Shipping Address Selection\n    $(\"select[name=userAddressesBilling]\").on(\"change\", function( ){\n        \n        var addressSelected = $(this).find(\":selected\").val( );\n        \n        if( addressSelected == 0 ){\n            $(\"input[name=billingAddress1]\").val( \"\" );\n            $(\"input[name=billingAddress2]\").val( \"\" );\n            $(\"input[name=billingCity]\").val( \"\" );\n            $(\"select[name=billingState] option\").each( function( i ){\n            \tif( i > 0 ){\n            \t\t$(this).remove( );\n            \t}\n            });\n            $(\"input[name=billingZip]\").val( \"\" );\n            $(\"select[name=billingCountry]>option:eq(0)\").prop(\"selected\", true);\n        }else{\n            \n            var addressData = addressSelected.split(\"|\");\n            \n            $(\"input[name=billingAddress1]\").val( addressData[2] );\n            $(\"input[name=billingAddress2]\").val( addressData[3] );\n            $(\"input[name=billingCity]\").val( addressData[4] );\n            $(\"input[name=billingZip]\").val( addressData[6] );\n            \n\t\t\t$(\"select[name=billingCountry]\").find(\"option[value=\" + addressData[7] + \"]\").prop(\"selected\", true);\n\n\t\t\t$(\"select[name=billingCountry]\").trigger(\"change\");\n\n            setTimeout( function( ){\n            \t$(\"select[name=billingState]\").find(\"option[value=\" + addressData[5] + \"]\").prop(\"selected\", true);\n\t\t\t}, 1000);\n\t\t\t\n        }\n    });\n\n    $(\".sameAsShipping\").on(\"change\", function( ){\n\n    \tif( $(this).is(\":checked\") ){\n\n    \t\t$(\"input[name=billingAddress1]\").val( $(\"input[name=shippingAddress1]\").val( ) );\n            $(\"input[name=billingAddress2]\").val( $(\"input[name=shippingAddress2]\").val( ) );\n            $(\"input[name=billingCity]\").val( $(\"input[name=shippingCity]\").val( ) );\n            $(\"input[name=billingZip]\").val( $(\"input[name=shippingZip]\").val( ) );\n\n            $(\"select[name=billingCountry]\").find(\"option[value=\" + $(\"select[name=shippingCountry]\").find(\"option:selected\").val( ) + \"]\").prop(\"selected\", true);\n\n\t\t\t$(\"select[name=billingCountry]\").trigger(\"change\");            \n\n\t\t\t$(\"select[name=billingState]\").find(\"option[value=\" + $(\"select[name=shippingState]\").find(\"option:selected\").val( ) + \"]\").prop(\"selected\", true);\n\t\t\t\n\t\t}\n\t});\n\n    //Action for checking out for Step 2 ( Details Page );\n    $(\".continueCheckout\").on(\"click\", function( ){\n        \n        var formData = $('form[name=fundCheckoutForm]').serialize( );\n        \n        var $button = $(this);\n\n        var error = \"\";\n\n        $(\".fund-error\").html( \"\" ).hide( );\n\n        if( fundObj.type == \"incentive\" ){\n        \tif( fundObj.incentive != \"\" ){\n\n        \t\tvar amount = $(\"[data-incentive-id=\" + fundObj.incentive + \"]\").find(\"input[name=donationAmt]\").val( );\n\n        \t\tif( amount == \"\" ){\n        \t\t\terror = \"Please Enter an Amount to Fund.\";\n        \t\t}else{\n        \t\t\tif( isNaN( parseFloat( amount ) ) ){\n        \t\t\t\terror = \"The donated amount must be a number.\";\n        \t\t\t}else{\n        \t\t\t\tfundObj.amount = parseFloat( amount ).formatMoney(2, ',', '.');\n        \t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n        \t\terror = \"Please Select an Incentive.\";\n        \t}\n        }else{\n\n        \tvar amount = $(\".details-fund\").find(\"input[name=donationAmt]\").val( );\n\n        \tif( amount == \"\" ){\n        \t\terror = \"Please Enter an Amount to Fund.\";\n        \t}else{\n        \t\tif( isNaN( parseFloat( amount ) ) ){\n    \t\t\t\terror = \"The donated amount must be a number.\";\n    \t\t\t}else{\n    \t\t\t\tfundObj.amount = parseFloat( amount ).formatMoney(2, ',', '.');\n    \t\t\t}\n        \t}\n        }\t\n\n        if( error == \"\" ){\n        \n\t        $.ajax({\n\t            url: \"/crowdfunding/validateFunding\",\n\t            method: \"POST\",\n\t            data: formData,\n\t            beforeSend: function( ){\n\t                \n\t                //clear any error messages\n\t                $(\".error\").html( \"\" ).hide( );\n\t                \n\t                //change button to show processing\n\t                $button.html( \"Validating...\");\n\t                $button.prop(\"disabled\", true);\n\t            },\n\t            success: function( ){\n\t                \n\t                $button.html( \"review order\");\n\t                $button.prop(\"disabled\", false);\n\t                \n\t                var $form = $('form[name=fundCheckoutForm]');\n\n\t                fundObj.first_name \t\t= $form.find(\"input[name=first_name]\").val( );\n\t                fundObj.last_name  \t\t= $form.find(\"input[name=last_name]\").val( );\n\t                fundObj.email\t\t\t= $form.find(\"input[name=email]\").val( );\n\t                fundObj.cc_number\t\t= $form.find(\"input[name=cc_number]\").val( );\n\t                fundObj.name_on_card  \t= $form.find(\"input[name=name_on_card]\").val( );\n\t                fundObj.exp_date\t\t= $form.find(\"select[name=exp_date_month]\").find(\"option:selected\").val( ) + \"\" + $form.find(\"select[name=exp_date_year]\").find(\"option:selected\").val( );\n\t                fundObj.exp_date_m\t\t= $form.find(\"select[name=exp_date_month]\").find(\"option:selected\").val( ); \n\t                fundObj.exp_date_y \t\t= $form.find(\"select[name=exp_date_year]\").find(\"option:selected\").text( );\n\t                fundObj.ccv \t\t\t= $form.find(\"input[name=ccv]\").val( );\n\n\t                var cc_mask = fundObj.cc_number.replace(/\\d{12}(\\d{4})/, \"XXXX XXXX XXXX $1\");\n\n\t\t\t\t\tfundObj.saveShippingAddress = false;\n\n\t\t\t\t\tif( $form.find(\"input[name=showShipping]\").val( ) == \"Y\" ){\n\n\t                \tfundObj.hasShippingData\t\t= 1;\n\n\t                \tfundObj.shippingAddr1 \t\t= $form.find(\"input[name=shippingAddress1]\").val( );\n\t                \tfundObj.shippingAddr2 \t\t= $form.find(\"input[name=shippingAddress2]\").val( );\n\t                \tfundObj.shippingCity \t\t= $form.find(\"input[name=shippingCity]\").val( );\n\t                \tfundObj.shippingState \t\t= $form.find(\"select[name=shippingState]\").find(\"option:selected\").text( );\n\t                \tfundObj.shippingStateId \t= $form.find(\"select[name=shippingState]\").find(\"option:selected\").val( );\n\t                \tfundObj.shippingZip \t\t= $form.find(\"input[name=shippingZip]\").val( );\n\t                \tfundObj.shippingCountry \t= $form.find(\"select[name=shippingCountry]\").find(\"option:selected\").text( );\n\t                \tfundObj.shippingCountryId \t= $form.find(\"select[name=shippingCountry]\").find(\"option:selected\").val( );\n\n\t                \tif( $form.find(\"input[name=saveShippingAddress]\").is(\":checked\") ){\n\t                \t\tfundObj.saveShippingAddress = true;\n\t                \t}\n\t                }else{\n\t                \tfundObj.hasShippingData = 0;\n\t                }\n\n\t                fundObj.billingAddr1 \t\t\t= $form.find(\"input[name=billingAddress1]\").val( );\n\t                fundObj.billingAddr2 \t\t\t= $form.find(\"input[name=billingAddress2]\").val( );\n\t                fundObj.billingCity \t\t\t= $form.find(\"input[name=billingCity]\").val( );\n\t                fundObj.billingState \t\t\t= $form.find(\"select[name=billingState]\").find(\"option:selected\").text( );\n\t                fundObj.billingStateId\t\t\t= $form.find(\"select[name=billingState]\").find(\"option:selected\").val( );\n\t                fundObj.billingZip \t\t\t\t= $form.find(\"input[name=billingZip]\").val( );\n\t                fundObj.billingCountry \t\t\t= $form.find(\"select[name=billingCountry]\").find(\"option:selected\").text( );\n\t                fundObj.billingCountryId \t\t= $form.find(\"select[name=billingCountry]\").find(\"option:selected\").val( );\n\n\t                fundObj.saveBillingAddress = false;\n\n\t                if( $form.find(\"input[name=saveBillingAddress]\").is(\":checked\") ){\n                \t\tfundObj.saveBillingAddress = true;\n                \t}\n\t                \n\t                var $review = $(\".fund-review\");\n\t                    \n\t                if( fundObj.type == \"incentive\" ){\n\n\t                \tvar $chosenIncentive = \n\t\t                $(\".fund-incentives-list\").find(\"[data-incentive-id=\" + fundObj.incentive + \"]\");\n\n\t\t\t\t\t\t$review.find(\".order-review-incentive\").find(\".header\").html( \"Incentive\" );\n\t                    \n\t                    $review.find(\".incentive-title\").html( $chosenIncentive.find(\".title\").text( ) ); \n\t                    \n\t                    $review.find(\".incentive-description\").html( $chosenIncentive.find(\".description\").text( ) );\n\t                    \n\t                }else{\n\t                    $review.find(\".order-review-incentive\").find(\".header\").html( \"Fund Amount\" );\n\t                }\n\t                \n\t                $review.find(\".donation-amount\").html( \"$\" + fundObj.amount );\n\n\t                if( $form.find(\"input[name=showShipping]\").val( ) == \"Y\" ){\n\n\t                \t$(\".order-review-shipping-address\").show( );\n\t                    \n\t\t                $review.find(\".shippingaddress1\").text( fundObj.shippingAddr1 );\n\n\t\t                $review.find(\".shippingaddress2\").text( fundObj.shippingAddr2 );\n\n\t\t                $review.find(\".shippingcity\").text( fundObj.shippingCity );\n\n\t\t                $review.find(\".shippingstate\").text( fundObj.shippingState );\n\n\t\t                $review.find(\".shippingzip\").text( fundObj.shippingZip );\n\n\t\t                $review.find(\".shippingcountry\").text( fundObj.shippingCountry );\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(\".order-review-shipping-address\").hide( );\n\t\t\t\t\t\t$(\".order-review-shipping-address\").prev( ).hide( );\n\t\t\t\t\t}\n\n\t\t\t\t\t$review.find(\".cc-num\").text( cc_mask );\n\n\t                $review.find(\".cc-name\").text( fundObj.name_on_card );\n\n\t                $review.find(\".cc-expdate\").text( fundObj.exp_date );\n\n\t                $review.find(\".cc-ccv\").text( fundObj.ccv );\n\t                \n\t\t\t\t\t$review.find(\".billingaddress1\").text( fundObj.billingAddr1 );\n\n\t                $review.find(\".billingaddress2\").text( fundObj.billingAddr2 );\n\n\t                $review.find(\".billingcity\").text( fundObj.billingCity );\n\n\t                $review.find(\".billingstate\").text( fundObj.billingState );\n\n\t                $review.find(\".billingzip\").text( fundObj.billingZip );\n\n\t                $review.find(\".billingcountry\").text( fundObj.billingCountry );\n\t                \n\t                $button.val( \"review order\");\n\t                $button.prop(\"disabled\", false);\n\n\t                $(\".donation-checkout\").slideUp(\"slow\", function( ){\n\n\t                \t$(\".project-fund-title, .project-fund-organization\").addClass('text-center');\n\n\t                \t$(\".fund-review\").slideDown(\"slow\");\n\t                });\n\t            },\n\t            statusCode: {\n\t                422: function( jqXHR, textStatus, errorThrown ){\n\t                    \n\t                    $button.html( \"review order\");\n\t                    $button.prop(\"disabled\", false);\n\t                    \n\t                    var errors = JSON.parse( jqXHR.responseText );\n\t                    \n\t                    for( var key in errors ){\n\t                        $(\".\" + key + \"-error\").html( errors[key] ).removeClass( 'hidden' ).show( );\n\t                    }\n\n\t                    $(\"html, body\").animate({scrollTop: 0},800);\n\t                }\n\t            }\n\t        });\n\t\t}else{\n\t\t\t$(\".fund-error\").html( error ).show( );\n\t\t\t$('html,body').scrollTop(0);\n\t\t}\n    });\n\n\t$(\".checkout-button\").on(\"click\", function( ){\n        \n        $donationId = \"\";\n        \n        var project_data = {\n            \"user_id\" :                 userId,\n            \"project_id\" :              id,\n            \"incentive_id\" :            fundObj.incentive,\n            \"project_title\" :           project_title,\n            \"incentive_title\" :         fundObj.incentiveName,\n            \"donation_amount\" :         fundObj.amount,\n            \"cc_number\": \t\t\t\tfundObj.cc_number,\n        \t\"ccv\": \t\t\t\t\t\tfundObj.ccv,\n        \t\"exp_date\": \t\t\t\tfundObj.exp_date,\n        \t\"first_name\":  \t\t\t\tfundObj.first_name,\n        \t\"last_name\": \t\t\t\tfundObj.last_name,\n        \t\"email\": \t\t\t\t\tfundObj.email, \n            \"billing_full_name\":        fundObj.first_name + \" \" + fundObj.last_name,\n            \"billing_first_name\":       fundObj.first_name,\n            \"billing_last_name\" :       fundObj.last_name,\n            \"billing_email\":            fundObj.email,\n            \"billing_address_line1\":    fundObj.billingAddr1,\n            \"billing_address_line2\":    fundObj.billingAddr2,\n            \"billing_city\":             fundObj.billingCity,\n            \"billing_state\":            fundObj.billingStateId,\n            \"billing_zip\":              fundObj.billingZip,\n            \"billing_country\":          fundObj.billingCountryId,\n            \"shipping_full_name\":       fundObj.first_name + \" \" + fundObj.last_name,\n            \"shipping_email\":           fundObj.email,\n            \"shipping_address_line1\":   fundObj.shippingAddr1,\n            \"shipping_address_line2\":   fundObj.shippingAddr2,\n            \"shipping_city\":            fundObj.shippingCity,\n            \"shipping_state\":           fundObj.shippingStateId,\n            \"shipping_zip\":             fundObj.shippingZip,\n            \"shipping_country\":         fundObj.shippingCountryId,\n            \"saveShippingAddress\": \t\tfundObj.saveShippingAddress,\n            \"saveBillingAddress\": \t\tfundObj.saveBillingAddress,\n            \"hasShippingData\": \t\t\tfundObj.hasShippingData,\n            \"payment_gateway\": \t\t\tpayment_gateway\n        };\n\n        $.ajax({\n            method: \"post\",\n            url: \"/crowdfunding/setPendingDonation\",\n            data: project_data,\n            dataType: \"json\",\n            success: function( data ){\n                \n                dataId = data.id;\n                \n                if( payment_gateway == 3 ){\n                 //find the paypalStdForm\n                \n\t                var $checkoutForm = $(\"form[name=paypalStdCheckout]\");\n\t                \n\t                //Input values into the form\n\t                $(\"input[name=cmd]\").val(\"_donations\");\n\t                $(\"input[name=return]\").val(window.location.protocol + \"//\" +  window.location.host + \"/thankyou\");\n\t                $(\"input[name=notify_url]\").val(window.location.protocol + \"//\" +  window.location.host + \"/project/ipn\");\n\n\t                $(\"input[name=amount]\").val( fundObj.amount );\n\n\t                $(\"input[name=custom]\").val( dataId + \"|\" + fundObj.incentive );\n\t                \n\t                $(\"input[name=business]\").val( paypal_username );\n\t                \n\t                $(\"input[name=first_name]\").val( fundObj.first_name );\n\t                \n\t                $(\"input[name=last_name]\").val( fundObj.last_name );\n\n\t                $(\"input[name=email]\").val( fundObj.email );\n\t                \n\t                $(\"input[name=address1]\").val( fundObj.billingAddr1 );\n\t                \n\t                $(\"input[name=address2]\").val( fundObj.billingAddr2 );\n\t                \n\t                $(\"input[name=city]\").val( fundObj.billingCity );\n\t                \n\t                $(\"input[name=state]\").val( fundObj.billingState );\n\t                \n\t                $(\"input[name=zip]\").val( fundObj.billingZip );\n\t                \n\t                $(\"input[name=country]\").val( fundObj.billingCountry );\n\t                \n\t                $checkoutForm.trigger(\"submit\");\n\t            }else{\n\n\t            \tif( data.status ){\n\n\t            \t\t$(\".project-fund-title\")\n\t            \t\t.html(\"<div class='checkout-thank-you-message'>Thank you for your Donation!</div><div style='font-size:12px;'> You will recieve an email shortly.</div>\");\n\n\t            \t\t$(\".project-fund-organization\")\n\t            \t\t.remove( );\n\n\t            \t\t$(\".fund-review\")\n\t            \t\t.find(\".header:first\")\n\t            \t\t.remove( );\n\n\t            \t\t$(\".order-review-incentive\")\n\t            \t\t.html(\"<p class='header'>Reference Number</p><div>\" + data.txnId + \"</div>\")\n\n\t            \t\t$(\"button.checkout-button\")\n\t            \t\t.remove( );\n\n\t            \t\t$(\"html, body\").animate({ scrollTop: \"0px\" });\n\t            \t}\n\t            }\n            }\n        });\n    });\n\n\t//Action for Shipping Address Selection\n    $(\"select[name=userAddresses]\").on(\"change\", function( ){\n        \n        var addressSelected = $(this).find(\":selected\").val( );\n        \n        if( addressSelected == 0 ){\n            $(\"input[name=billingAddress1]\").val( \"\" );\n            $(\"input[name=billingAddress2]\").val( \"\" );\n            $(\"input[name=billingCity]\").val( \"\" );\n            $(\"select[name=billingState] option\").each( function( i ){\n            \tif( i > 0 ){\n            \t\t$(this).remove( );\n            \t}\n            });\n            $(\"input[name=billingZip]\").val( \"\" );\n            $(\"select[name=billingCountry]>option:eq(0)\").prop(\"selected\", true);\n        }else{\n            \n            var addressData = addressSelected.split(\"|\");\n            \n            $(\"input[name=billingAddress1]\").val( addressData[2] );\n            $(\"input[name=billingAddress2]\").val( addressData[3] );\n            $(\"input[name=billingCity]\").val( addressData[4] );\n            $(\"input[name=billingZip]\").val( addressData[6] );\n            \n\t\t\t$(\"select[name=billingCountry]\").find(\"option[value=\" + addressData[7] + \"]\").prop(\"selected\", true);\n\n\t\t\t$(\"select[name=billingCountry]\").trigger(\"change\");\n\n\t\t\tsetTimeout( function( ){\n\t\t\t\t$(\"select[name=billingState]\").find(\"option[value=\" + addressData[5] + \"]\").prop(\"selected\", true);\n\t\t\t}, 1000);\n\t\t}\n    });\n\n    $(\".edit-button\").on(\"click\", function( e ){\n\n    \t$review \t= $(\".fund-review\");\n\t    $donateForm = $(\".donation-checkout\");\n\n\t    $review.slideUp(\"slow\", function( ){\n        \t$donateForm.slideDown(\"slow\");\n        });\n\t});\n});"],"sourceRoot":"/source/"}