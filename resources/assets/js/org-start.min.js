$(function(){function C(){var n=h.length;console.dir(h),$(".checkout").find("[data-step="+(n+1)+"]").animate({marginLeft:"0px"},"slow"),$(".checkout").find("[data-step="+n+"]").animate({marginLeft:"-590px"},"slow")}function A(){var n=h.length;$(".checkout").find("[data-step="+n+"]").animate({marginLeft:"0px"},"slow"),$(".checkout").find("[data-step="+(n+1)+"]").animate({marginLeft:"999999px"},"slow")}function k(n){for(var i in h)if(h[i].step==n)return!0;return!1}function w(n,i){for(var a in h)h[a].step==i&&(h[a].data=n)}function S(n,i){for(var a in h)if(h[a].step==n)for(var t in h[a].data)if(t==i)return h[a].data[t]}var n;$(".cause-name").on("click",function(){var n=$(this).data("cause");$(".cause-name").removeClass("active"),$(this).addClass("active"),$(".cause-description").addClass("hidden"),$("."+n+"-description").removeClass("hidden")});var a=new google.maps.LatLngBounds,e=(new google.maps.InfoWindow,new Array),o=(new Array,new Array);$(".area-list > div").each(function(){$obj=new Object,$obj.name=$(this).find(".country-name").text(),$obj.lat=parseFloat($(this).find("input[name=lat]").val()),$obj.lng=parseFloat($(this).find("input[name=lng]").val()),$obj.alias=$(this).find("input[name=alias]").val(),o.push($obj),console.dir($obj)});var d=document.getElementById("map"),s={zoom:5,center:new google.maps.LatLng(o[0].lat,o[0].lng),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:styles,animatedZoom:!0,disableDefaultUI:!0},u=new google.maps.Map(d,s);u.addListener("mouseover",function(){u.setOptions({disableDefaultUI:!1})}),u.addListener("mouseout",function(){u.setOptions({disableDefaultUI:!0})});for(x in o){var r=new google.maps.InfoWindow({content:"<b>"+o[x].name+"</b><br /><a href='/country/"+o[x].alias+"'>View Country</a>"});e.push(new google.maps.Marker({position:{lat:o[x].lat,lng:o[x].lng},map:u,animation:google.maps.Animation.DROP,title:o[x].name,infowindow:r}))}for(i in e)google.maps.event.addListener(e[i],"click",function(){"undefined"!=typeof n&&n.close(),n=this.infowindow,this.infowindow.open(u,this)}),a.extend(e[i].position),u.fitBounds(a),initialZoom=1;var y,m=$("input[name=paypalUn]").val(),c=$("form[name=donationCheckoutForm]").find("input[name=user_id]").val(),f=$("#organizationCheckout"),p=$("#organizationCheckout").find(".checkout"),v=p.find(".donation"),g=p.find(".details"),b=p.find(".review"),h=[],_=4;$(".donate-button").on({mouseover:function(){$(this).css("cursor","pointer")},mouseleave:function(){$(this).css("cursor","auto")},click:function(){y=$(this).data("id");for(var n=0;_>n;n++)0==n?p.find("[data-step="+(n+1)+"]").css("marginLeft","0px"):p.find("[data-step="+(n+1)+"]").css("marginLeft","999999px");f.css("display","table")}}),$(".exit-organization-checkout").on({mouseover:function(){$(this).css("cursor","pointer")},mouseleave:function(){$(this).css("cursor","auto")},click:function(){h=[],v.find("input").val(""),$("form[name=donationCheckoutForm]")[0].reset(),$("#organizationCheckout").hide()}}),v.find(".continue").on("click",function(){var n=v.find("input[name=donationAmt]").val(),i=new Array;0==i.length&&(k(1)?w({amount:n},1):h.push({step:1,data:{amount:n}}),p.find(".details").find(".donation-amount span").html(n),C())}),g.find("button.donation-button").on("click",function(){A()}),$("select[name=userAddresses]").on("change",function(){var n=$(this).find(":selected").val();if(0==n)$("input[name=billingAddress1]").val(""),$("input[name=billingAddress2]").val(""),$("input[name=billingCity]").val(""),$("input[name=billingState]").val(""),$("input[name=billingZip]").val(""),$("input[name=billingCountry]").val("");else{var i=n.split("|");$("input[name=billingAddress1]").val(i[2]),$("input[name=billingAddress2]").val(i[3]),$("input[name=billingCity]").val(i[4]),$("input[name=billingState]").val(i[5]),$("input[name=billingZip]").val(i[6]),$("input[name=billingCountry]").val(i[7])}}),$(".continueCheckout").on("click",function(){var n=$("form[name=donationCheckoutForm]").serialize(),i=$(this);$.ajax({url:"/organization/validateDonation",method:"POST",data:n,beforeSend:function(){$(".error").html("").addClass("hidden"),i.html("Validating..."),i.prop("disabled",!0)},success:function(){i.html("Processing...");var n=$("form[name=donationCheckoutForm]");k(2)?w({first_name:n.find("input[name=first_name]").val(),last_name:n.find("input[name=last_name]").val(),email:n.find("input[name=email]").val(),cc_num:n.find("input[name=cc_number]").val(),name_on_card:n.find("input[name=name_on_card]").val(),exp_date:n.find("input[name=exp_date]").val(),ccv:n.find("input[name=ccv]").val(),billingAddr1:n.find("input[name=billingAddress1]").val(),billingAddr2:n.find("input[name=billingAddress2]").val(),billingCity:n.find("input[name=billingCity]").val(),billingState:n.find("input[name=billingState]").val(),billingZip:n.find("input[name=billingZip]").val(),billingCountry:n.find("input[name=billingCountry]").val()},2):h.push({step:2,data:{first_name:n.find("input[name=first_name]").val(),last_name:n.find("input[name=last_name]").val(),email:n.find("input[name=email]").val(),cc_num:n.find("input[name=cc_number]").val(),name_on_card:n.find("input[name=name_on_card]").val(),exp_date:n.find("input[name=exp_date]").val(),ccv:n.find("input[name=ccv]").val(),billingAddr1:n.find("input[name=billingAddress1]").val(),billingAddr2:n.find("input[name=billingAddress2]").val(),billingCity:n.find("input[name=billingCity]").val(),billingState:n.find("input[name=billingState]").val(),billingZip:n.find("input[name=billingZip]").val(),billingCountry:n.find("input[name=billingCountry]").val()}}),b.find(".donation-amount").html(S(1,"amount")),b.find(".cc-num").text(g.find("input[name='cc_number']").val()),b.find(".cc-name").text(g.find("input[name='name_on_card']").val()),b.find(".cc-expdate").text(g.find("input[name='exp_date']").val()),b.find(".cc-ccv").text(g.find("input[name='ccv']").val()),b.find(".billingaddress1").text(g.find("input[name='billingAddress1']").val()),b.find(".billingaddress2").text(g.find("input[name='billingAddress2']").val()),b.find(".billingcity").text(g.find("input[name='billingCity']").val()),b.find(".billingstate").text(g.find("input[name='billingState']").val()),b.find(".billingzip").text(g.find("input[name='billingZip']").val()),b.find(".billingcountry").text(g.find("input[name='billingCountry']").val()),i.val("review order"),i.prop("disabled",!1),C()},statusCode:{422:function(n){var t=JSON.parse(n.responseText);for(var e in t)$("."+e+"-error").html(t[e]).removeClass("hidden")}}})}),b.find(".checkout-button").on("click",function(){$donationId="";{var n=new Date;n.getYear()+"-"+n.getMonth()+"-"+n.getDate()+" "+n.getHours()+":"+n.getMinutes()+":"+n.getMilliseconds()}$.ajax({method:"get",url:"/setPendingDonation",data:{user_id:c,item_id:y,item_type:"organization",billing_full_name:S(2,"first_name")+" "+S(2,"last_name"),billing_address_line1:S(2,"billingAddr1"),billing_address_line2:S(2,"billingAddr2"),billing_city:S(2,"billingCity"),billing_state:S(2,"billingState"),billing_country:S(2,"billingCountry"),billing_zip:S(2,"billingZip"),donation_amount:S(1,"amount")},dataType:"json",success:function(n){dataId=n.id;var i=$("form[name=paypalStdCheckout]");$("input[name=cmd]").val("_donations"),$("input[name=return]").val("http://pwi.dev.com/thankyou"),$("input[name=notify_url]").val("http://pwi.dev.com/ipn"),$("input[name=amount]").val(S(1,"amount")),$("input[name=custom]").val(dataId),$("input[name=business]").val(m),$("input[name=first_name]").val(S(2,"first_name")),$("input[name=last_name]").val(S(2,"last_name")),$("input[name=address1]").val(S(2,"billingAddr1")),$("input[name=address2]").val(S(2,"billingAddr2")),$("input[name=city]").val(S(2,"billingCity")),$("input[name=state]").val(S(2,"billingState")),$("input[name=zip]").val(S(2,"billingZip")),$("input[name=country]").val(S(2,"billingCountry")),i.trigger("submit")}})}),b.find(".edit-button").on("click",function(){A()})});